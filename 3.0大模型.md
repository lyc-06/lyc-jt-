# JoTangLM3.0å¤§æ¨¡å‹â€”äº¤äº’é¡µé¢åˆ¶ä½œè¿‡ç¨‹
## 1. é¡µé¢ç»“æ„è®¾è®¡
- ä¾§è¾¹æ (é¡¶éƒ¨logoã€æ–°å»ºå¯¹è¯æŒ‰é’®åŠå¯¹è¯åˆ—è¡¨ã€ä¸ªæ€§åŒ–è®¾ç½®)
- ä¸»ä½“å†…å®¹åŒºï¼ˆè¾“å…¥æ¡†ã€è¾“å‡ºæ¡†ã€æ¨¡å¼åˆ‡æ¢æŒ‰é’®ï¼‰
  
## 2. ä¾§è¾¹æ æ ·å¼è®¾è®¡
### 2.1 é¡¶éƒ¨logoå›ºå®š
è®¾ç½®é¡¶éƒ¨logoæ ·å¼ï¼ŒåŒ…æ‹¬å±…ä¸­ã€å¤§å°ã€é¢œè‰²ç­‰ï¼Œåœ¨logoä¸‹æ–¹æ·»åŠ ä¸€æ¡å®çº¿åˆ†å‰²çº¿ã€‚
```css
.sidebar-header {
            height: var(--header-height);
            display: flex;
            align-items: center;
            padding: 0 1rem;
            border-bottom: 1px solid #e5e7eb;/* åœ¨logoåº•éƒ¨è®¾è®¡å®çº¿è¾¹æ¡† */
        }

        .logo {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }
```
### 2.2 ä¾§è¾¹æ æ ·å¼
åœ¨ä¾§è¾¹æ å³ä¾§è®¾è®¡å®çº¿è¾¹æ¡†ï¼Œå¢åŠ é˜´å½±ï¼Œä½¿å¾—ä¾§è¾¹æ æœ‰æµ®èµ·æ¥çš„æ„Ÿè§‰ã€‚
```css
 border-right: 1px solid #e5e7eb;/* åœ¨å³ä¾§è®¾è®¡å®çº¿è¾¹æ¡† */
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1); /* æ·»åŠ é˜´å½± */
 ```

 ### 2.3 æ–°å»ºå¯¹è¯æŒ‰é’®
 è®¾ç½®æ–°å»ºå¯¹è¯æŒ‰é’®æ ·å¼ï¼ŒåŒ…æ‹¬å¤§å°ã€é¢œè‰²ã€è¾¹æ¡†ç­‰ï¼Œå¹¶æ·»åŠ é¼ æ ‡æ‚¬æµ®æ ·å¼ã€‚
 ```css
 .new-chat-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 0.375rem;/* åœ†è§’ */
            font-weight: 600;
            cursor: pointer;/* é¼ æ ‡æŒ‡é’ˆ */
            margin-bottom: 1rem;
            width: 100%;
        }
```
### 2.4 èŠå¤©åˆ—è¡¨æ ·å¼
- è®¾ç½®èŠå¤©åˆ—è¡¨æ ·å¼ï¼ŒåŒ…æ‹¬èƒŒæ™¯è‰²ã€å­—ä½“é¢œè‰²ã€å­—ä½“å¤§å°ã€è¾¹æ¡†ç­‰ã€‚
- è®¾ç½®é¼ æ ‡æ‚¬åœæ—¶é¢œè‰²æ”¹å˜ã€‚
```css
.chat-item:hover {
            background-color: #f3f4f6;/* é¼ æ ‡æ‚¬åœæ—¶ï¼ŒèƒŒæ™¯é¢œè‰²æ”¹å˜ä¸ºä¸€ç§æ·¡ç°è‰² */
        }
```
- è®¾ç½®é€‰ä¸­æŸä¸ªèŠå¤©æ—¶ï¼ŒèƒŒæ™¯é¢œè‰²å›ºå®šï¼Œçªå‡ºæ˜¾ç¤ºã€‚
```css
.chat-item.active {
            background-color: #e9e3ff;/* é€‰ä¸­æ—¶ï¼ŒèƒŒæ™¯é¢œè‰²æ”¹å˜ä¸ºä¸€ç§ç°è‰² */
        }
```

### 2.5 åˆ é™¤èŠå¤©æŒ‰é’®æ ·å¼
- é»˜è®¤éšè—ï¼Œå½“é¼ æ ‡æ‚¬æµ®åœ¨èŠå¤©åˆ—è¡¨ä¸Šæ—¶ï¼Œæ˜¾ç¤ºåˆ é™¤æŒ‰é’®ã€‚
  ```css
  .delete-chat {
            visibility: hidden;/* é»˜è®¤éšè— */
            cursor: pointer;/* é¼ æ ‡æŒ‡é’ˆ */
        }

        .chat-item:hover .delete-chat {
            visibility: visible;/* é¼ æ ‡æ‚¬åœæ—¶ï¼Œæ˜¾ç¤ºåˆ é™¤æŒ‰é’® */
        }
  ```
### 2.6 ä¾§è¾¹æ åº•éƒ¨è®¾ç½®åŒºæ ·å¼
- è®¾ç½®æŒ‰é’®æ ·å¼ï¼ŒåŒ…æ‹¬å¤§å°ã€é¢œè‰²ã€è¾¹æ¡†ã€é¼ æ ‡æ‚¬æµ®æ•ˆæœç­‰ï¼Œå¹¶æŒ‰ç…§é¡µé¢è®¾è®¡è§„å¾‹ï¼Œå°†æ–‡å­—å·¦å¯¹é½ã€‚
  ```css
   text-align: left;/* æ–‡æœ¬å·¦å¯¹é½ */
  ```
```css
.settings-btn:hover {
            background-color: #f3f4f6;/* é¼ æ ‡æ‚¬åœæ—¶ï¼ŒèƒŒæ™¯é¢œè‰²æ”¹å˜ä¸ºä¸€ç§æ·¡ç°è‰² */
            border-radius: 0.375rem;
        }
```
- è®¾ç½®å¼¹çª—åŠå…¶å†…å®¹æ ·å¼ï¼ŒåŒ…æ‹¬èƒŒæ™¯è‰²ã€å­—ä½“é¢œè‰²ã€å­—ä½“å¤§å°ã€è¾¹æ¡†ç­‰ï¼Œå¹¶é€šè¿‡è®¾ç½®å…¶ä½™éƒ¨åˆ†çš„èƒŒæ™¯é¢œè‰²å’Œé€æ˜åº¦ï¼Œå‡¸æ˜¾è®¾ç½®çª—å£ 
```css
background-color: rgba(0,0,0,0.4);
```
- è®¾ç½®å¼¹çª—å…³é—­æŒ‰é’®æ ·å¼ã€‚
 
## 3. ä¸»ä½“å†…å®¹åŒºæ ·å¼è®¾è®¡
### 3.1 è¾“å…¥æ¡†æ ·å¼è®¾è®¡
- è®¾ç½®è¾“å…¥æ¡†åŸºæœ¬æ ·å¼ã€‚
- å›ºå®šè¾“å…¥æ¡†é«˜åº¦ï¼Œä½¿å¾—å†…å®¹è¿‡å¤šæ—¶å‡ºç°æ»šåŠ¨æ¡ï¼Œè€Œä¸æ˜¯æ— é™å¢å¤§ã€‚
  ```css
  overflow: hidden; /* éšè—æ»šåŠ¨æ¡ */
    resize: none; /* ç¦ç”¨ç”¨æˆ·è°ƒæ•´å¤§å° */
    min-height: 40px; /* è®¾ç½®æœ€å°é«˜åº¦ */
    max-height: 80px; /* è®¾ç½®æœ€å¤§é«˜åº¦ */
  ```
### 3.2 è¾“å‡ºæ¡†æ ·å¼è®¾è®¡
- å®šä¹‰èŠå¤©æ¶ˆæ¯çš„å¤–è§‚æ ·å¼ï¼ŒåŒ…æ‹¬æœ€å¤§å®½åº¦ã€ä¸Šä¸‹æ–‡é—´è·ã€å†…è¾¹è·ã€åœ†è§’æ•ˆæœå’Œè¡Œé«˜è®¾ç½®ã€‚
```css

        .message {
            max-width: 80%;
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 0.5rem;
            line-height: 1.5;
        }
```
- å°†ç”¨æˆ·æ¶ˆæ¯å³å¯¹é½ï¼ŒAIå›å¤å·¦å¯¹é½ã€‚
  ```css
   .user-message {
            align-self: flex-end;/* å³å¯¹é½ */
            background-color: var(--primary-color);
            color: white;
        }

        .ai-message {
            align-self: flex-start;/* å·¦å¯¹é½ */
            background-color: #e5e7eb;
        }
  ```  

### 3.3 æ¨¡å¼åˆ‡æ¢æŒ‰é’®
- è®¾ç½®èƒŒæ™¯é¢œè‰²ã€åœ†è§’ã€é¼ æ ‡æ‚¬æµ®ç­‰æ•ˆæœã€‚
  ```css
   .mode-button {
    background-color: var(--primary-color); /* é»˜è®¤èƒŒæ™¯è‰² */
    color: white; /* æ–‡å­—é¢œè‰² */
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .mode-button:hover {
    background-color: #7a4fcf; /* é¼ æ ‡æ‚¬åœæ—¶çš„é»˜è®¤é¢œè‰² */
  }
  ```

## 4. scriptå‡½æ•°è®¾ç½®
### 4.1 åˆ‡æ¢ä¸¤ç§å›ç­”æ¨¡å¼  (toggleModeå‡½æ•°)
```javascript
        function toggleMode() {
          currentMode = currentMode === 'concise' ? 'professional' : 'concise';//å¦‚æœ currentMode çš„å€¼æ˜¯ 'concise'ï¼ˆç®€æ´æ¨¡å¼ï¼‰ï¼Œé‚£ä¹ˆå®ƒä¼šå°† currentMode çš„å€¼æ›´æ”¹ä¸º 'professional'ï¼ˆä¸“ä¸šæ¨¡å¼ï¼‰ã€‚
  const modeToggleButton = document.getElementById('mode-toggle');// è·å–æ¨¡å¼åˆ‡æ¢æŒ‰é’®çš„ DOM å…ƒç´ 
  modeToggleButton.textContent = currentMode === 'concise' ? 'ç®€æ´æ¨¡å¼' : 'ä¸“ä¸šæ¨¡å¼';// æ ¹æ®å½“å‰æ¨¡å¼ï¼Œæ›´æ–°æŒ‰é’®çš„æ–‡æœ¬å†…å®¹:å¦‚æœ currentMode æ˜¯ 'concise'ï¼Œé‚£ä¹ˆæŒ‰é’®çš„æ–‡æœ¬å°†æ˜¾ç¤ºä¸º 'ç®€æ´æ¨¡å¼'ã€‚å¦‚æœå½“å‰æ¨¡å¼æ˜¯ 'professional'ï¼Œé‚£ä¹ˆæŒ‰é’®å°†æ˜¾ç¤ºä¸º 'ä¸“ä¸šæ¨¡å¼'ã€‚
  }
```

### 4.2 æœ¬åœ°å­˜å‚¨
```javascript
 // æœ¬åœ°å­˜å‚¨
        function loadChats() {
            const savedChats = localStorage.getItem('chats');// ä»localStorageè·å–ä¿å­˜çš„èŠå¤©è®°å½•
            if (savedChats) {// å¦‚æœä¸Šä¸€æ­¥è·å–çš„ savedChats å­˜åœ¨,å³æœ‰ä¿å­˜çš„èŠå¤©è®°å½•ï¼Œè¿›å…¥ifè¯­å¥
                chats = JSON.parse(savedChats);//ä½¿ç”¨ JSON.parse æ–¹æ³•å°†è·å–åˆ°çš„å­—ç¬¦ä¸²æ ¼å¼çš„èŠå¤©è®°å½•è½¬æ¢ä¸º JavaScript å¯¹è±¡ï¼Œå¹¶èµ‹å€¼ç»™ chats å˜é‡ã€‚
                updateChatList();//æ›´æ–°ç•Œé¢ä¸Šçš„èŠå¤©åˆ—è¡¨ï¼Œä»¥ä¾¿åœ¨åŠ è½½æ–°è®°å½•åæ˜¾ç¤ºå®ƒä»¬ã€‚
            }
        }

        // å°†èŠå¤©è®°å½•ï¼ˆå­˜å‚¨åœ¨ chats æ•°ç»„ä¸­ï¼‰ä¿å­˜åˆ°æµè§ˆå™¨çš„æœ¬åœ°å­˜å‚¨ä¸­ï¼Œä»¥ä¾¿åœ¨ç”¨æˆ·åˆ·æ–°é¡µé¢æˆ–å…³é—­æµè§ˆå™¨åï¼Œèƒ½å¤Ÿæ¢å¤ä¹‹å‰çš„èŠå¤©è®°å½•ã€‚
        function saveChats() {
            localStorage.setItem('chats', JSON.stringify(chats));
        }
```

### 4.3 æ–°å»ºèŠå¤©
```javascript
//æ–°å»ºèŠå¤©
function createNewChat() {
    const chatId = Date.now();//è·å–å½“å‰æ—¶é—´æˆªï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ ID ä½œä¸ºå¯¹è¯çš„æ ‡è¯†ç¬¦
    const chat = {
        id: chatId,  //å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œæ¥è‡ªå‰é¢çš„æ—¶é—´æˆ³ã€‚
        name: `å¯¹è¯ ${chats.length + 1}`,//èŠå¤©çš„åç§°ï¼Œæ ¼å¼ä¸ºâ€œå¯¹è¯ nâ€ï¼Œå…¶ä¸­ n æ˜¯å½“å‰ chats æ•°ç»„ä¸­å·²æœ‰ä¼šè¯çš„æ•°é‡åŠ ä¸€ã€‚
        messages: [],
        index: chats.length + 1 // è®¾ç½®åºå·
    };
    
    chats.push(chat);//å°†æ–°åˆ›å»ºçš„èŠå¤©å¯¹è±¡ chat æ·»åŠ åˆ° chats æ•°ç»„ä¸­ï¼Œchats æ•°ç»„ç”¨äºå­˜å‚¨æ‰€æœ‰çš„èŠå¤©ä¼šè¯ã€‚
    currentChatId = chatId;//å°† currentChatId æ›´æ–°ä¸ºå½“å‰æ–°å»ºèŠå¤©çš„ IDï¼Œä»¥ä¾¿åç»­æ“ä½œå¯ä»¥åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­è¿›è¡Œã€‚
    updateChatList();//è°ƒç”¨ updateChatList() å‡½æ•°ï¼Œé‡æ–°æ¸²æŸ“èŠå¤©åˆ—è¡¨ç•Œé¢ï¼Œä»¥ä½¿æ–°åˆ›å»ºçš„èŠå¤©å¯è§ã€‚
    clearChatContainer();//è°ƒç”¨ clearChatContainer() å‡½æ•°ï¼Œæ¸…ç©ºå½“å‰èŠå¤©æ˜¾ç¤ºåŒºåŸŸï¼Œä»¥ä¾¿ä¸ºæ–°èŠå¤©åšå‡†å¤‡ã€‚
    saveChats();//è°ƒç”¨ saveChats() å‡½æ•°å°†å½“å‰çš„èŠå¤©ä¼šè¯ä¿¡æ¯ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ä¸­ï¼Œ
}
```
### 4.4 æ›´æ–°èŠå¤©åˆ—è¡¨
```javascript
//æ›´æ–°èŠå¤©åˆ—è¡¨çš„æ˜¾ç¤º
function updateChatList() {
    const chatList = document.getElementById('chat-list');//å°† chatList çš„å†…å®¹æ¸…ç©ºï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æˆ‘ä»¬æ¯æ¬¡æ›´æ–°èŠå¤©åˆ—è¡¨æ—¶éƒ½ä»ä¸€ä¸ªç©ºç™½çŠ¶æ€å¼€å§‹ï¼Œé¿å…æ—§çš„èŠå¤©é¡¹å†…å®¹æ®‹ç•™ã€‚
    chatList.innerHTML = '';
    const newColor = document.getElementById('theme-color').value; // è·å–ä¸€ä¸ª input å…ƒç´ çš„å€¼ï¼Œè¯¥å…ƒç´ å…è®¸ç”¨æˆ·é€‰æ‹©ä¸»é¢˜é¢œè‰²ã€‚
    chats.forEach(chat => {//å¾ªç¯,å¯¹äºæ¯ä¸ªèŠå¤©å¯¹è±¡ï¼Œä»¥ä¸‹æ“ä½œéƒ½ä¼šæ‰§è¡Œã€‚
        const chatItem = document.createElement('div');
        chatItem.className = `chat-item ${chat.id === currentChatId ? 'active' : ''}`;//chatItem çš„ç±»åè¢«è®¾ç½®ä¸º chat-itemã€‚åŒæ—¶ï¼Œä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å½“å‰èŠå¤©çš„IDæ˜¯å¦ä¸å½“å‰æ¿€æ´»çš„èŠå¤©IDç›¸åŒã€‚å¦‚æœç›¸åŒï¼Œå°±ä¼šç»™è¿™ä¸ªèŠå¤©é¡¹æ·»åŠ é¢å¤–çš„ç±»å activeï¼Œä»è€Œå¯ä»¥ä½¿ç”¨CSSæ ·å¼æ¥çªå‡ºæ˜¾ç¤ºå½“å‰é€‰ä¸­çš„èŠå¤©é¡¹ã€‚
        //divå’Œspanå…ƒç´ 
        chatItem.innerHTML = `
            <div class="chat-item-content" onclick="switchChat(${chat.id})"> 
                <div class="chat-item-icon"></div> 
                <div class="chat-item-name">${chat.name}</div>
            </div>
            <span class="delete-chat" onclick="deleteChat(${chat.id})">ğŸ—‘ï¸</span>
        `;
        chatList.appendChild(chatItem);//å°†åˆ›å»ºçš„ chatItem æ·»åŠ åˆ° chatList ä¸­ï¼Œä½¿å…¶æ˜¾ç¤ºåœ¨ç”¨æˆ·ç•Œé¢ä¸Šã€‚
    });
}
```
### 4.5 åˆ‡æ¢èŠå¤©
```javascript
//åˆ‡æ¢å½“å‰èŠå¤©ä¼šè¯
function switchChat(chatId) {
            currentChatId = chatId;//æ›´æ–°å½“å‰èŠå¤©çš„ID
            clearChatContainer();//è°ƒç”¨ clearChatContainer() å‡½æ•°ï¼Œæ¸…ç©ºå½“å‰èŠå¤©å†…å®¹æ˜¾ç¤ºåŒºåŸŸã€‚
            const chat = chats.find(c => c.id === chatId);//ä½¿ç”¨ find æ–¹æ³•ä» chats æ•°ç»„ä¸­æ‰¾åˆ°ä¸æä¾›çš„ chatId åŒ¹é…çš„èŠå¤©å¯¹è±¡ã€‚
            document.getElementById('current-chat-title').textContent = chat.name;//å°†æ‰¾åˆ°çš„èŠå¤©å¯¹è±¡çš„åç§°ï¼ˆchat.nameï¼‰è®¾ç½®ä¸ºç•Œé¢ä¸Šå½“å‰èŠå¤©æ ‡é¢˜çš„æ–‡æœ¬å†…å®¹ã€‚
            chat.messages.forEach(msg => addMessageToChat(msg.text, msg.sender));
            updateChatList();//è°ƒç”¨ updateChatList() å‡½æ•°ï¼Œä»¥æ›´æ–°èŠå¤©åˆ—è¡¨çš„çŠ¶æ€
        }
```
### 4.6 åˆ é™¤èŠå¤©
```javascript
/åˆ é™¤ç‰¹å®šèŠå¤©å¯¹è¯
        function deleteChat(chatId) {
    const index = chats.findIndex(c => c.id === chatId);
    if (index > -1)   { //æ£€æŸ¥æ‰¾åˆ°çš„ç´¢å¼•æ˜¯å¦æœ‰æ•ˆï¼ˆå³æ˜¯å¦å­˜åœ¨ï¼‰ã€‚å¦‚æœ index å¤§äº -1ï¼Œè¡¨ç¤ºæˆåŠŸæ‰¾åˆ°è¦åˆ é™¤çš„èŠå¤©ã€‚
        chats.splice(index, 1);//index æ˜¯è¦åˆ é™¤å…ƒç´ çš„èµ·å§‹ä½ç½®ï¼Œ1 æ˜¯è¦åˆ é™¤çš„å…ƒç´ ä¸ªæ•°ã€‚
    }
        }
```
### 4.7 åˆ é™¤å¯¹è¯ååˆ—è¡¨åºå·é‡æ–°æ’åˆ—
```javascript
 // åˆ é™¤èŠå¤©ä¼šè¯å,é‡æ–°æ’åºåºå·
        chats.forEach((chat, idx) => {
            chat.index = idx + 1; // æ›´æ–°åºå·ä»1å¼€å§‹
            chat.name = `å¯¹è¯ ${idx + 1}`; // æ›´æ–°åç§°ä»¥åæ˜ æ–°çš„é¡ºåº
        });
        if (currentChatId === chatId) {//å¦‚æœå½“å‰æ´»åŠ¨èŠå¤©çš„ IDï¼ˆcurrentChatIdï¼‰ç­‰äºè¢«åˆ é™¤èŠå¤©çš„ IDï¼ˆchatIdï¼‰ï¼Œåˆ™éœ€è¦å¤„ç†å½“å‰æ´»åŠ¨èŠå¤©çš„æ›´æ–°ã€‚
            currentChatId = chats.length > 0 ? chats[chats.length - 1].id : null;//å°† currentChatId æ›´æ–°ä¸ºå½“å‰èŠå¤©åˆ—è¡¨çš„æœ€åä¸€ä¸ªèŠå¤©çš„ IDï¼Œè‹¥èŠå¤©åˆ—è¡¨ä¸ºç©ºï¼Œåˆ™è®¾ç½®ä¸º nullã€‚
            if (currentChatId) {
                switchChat(currentChatId);//å¦‚æœ currentChatId ä»ç„¶æœ‰æ•ˆï¼ˆå³å­˜åœ¨èŠå¤©ï¼‰ï¼Œè°ƒç”¨ switchChat() åˆ‡æ¢åˆ°è¯¥èŠå¤©ã€‚
            } else {
                clearChatContainer();
                document.getElementById('current-chat-title').textContent = 'æ–°å¯¹è¯';//å¦‚æœæ²¡æœ‰æœ‰æ•ˆçš„èŠå¤©ï¼Œè°ƒç”¨ clearChatContainer() æ¸…ç©ºèŠå¤©æ˜¾ç¤ºåŒºåŸŸï¼Œå¹¶å°†å½“å‰èŠå¤©æ ‡é¢˜è®¾ç½®ä¸ºâ€œæ–°å¯¹è¯â€ã€‚
            }
        }
        updateChatList();//è°ƒç”¨ updateChatList() å‡½æ•°ï¼Œä»¥æ›´æ–°èŠå¤©åˆ—è¡¨çš„çŠ¶æ€ã€‚
        saveChats();//è°ƒç”¨ saveChats() å‡½æ•°å°†å½“å‰çš„èŠå¤©ä¼šè¯ä¿¡æ¯ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ä¸­ã€‚
  ```
  ### 4.8 å›ºå®šè¾“å…¥æ¡†é«˜åº¦ï¼Œè‡ªé€‚åº”å‡ºç°æ»šåŠ¨æ¡
  ```javascript
  //å®ç°ä¸€ä¸ªè‡ªé€‚åº”é«˜åº¦çš„æ–‡æœ¬è¾“å…¥æ¡†
        function autoResizeTextarea() {
    const textarea = document.getElementById('user-input');//ä½¿ç”¨ document.getElementById æ–¹æ³•è·å–å…·æœ‰ ID user-input çš„æ–‡æœ¬åŒºåŸŸå…ƒç´ ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™å˜é‡ textareaã€‚è¿™å…è®¸ä»¥åå¯¹è¯¥æ–‡æœ¬åŒºåŸŸè¿›è¡Œæ“ä½œã€‚
    textarea.style.height = 'auto'; // å…ˆé‡ç½®ä¸ºâ€œè‡ªåŠ¨â€ä»¥è®¡ç®—çœŸå®é«˜åº¦
    const newHeight = Math.min(textarea.scrollHeight, 100); // è®¡ç®—å½“å‰é«˜åº¦ï¼Œå¹¶ä½¿ç”¨ Math.min() æ–¹æ³•é™åˆ¶æœ€å¤§é«˜åº¦ä¸º 100px
    textarea.style.height = `${textarea.scrollHeight}px`; // å°†æ–‡æœ¬åŒºåŸŸçš„é«˜åº¦è®¾ç½®ä¸ºè®¡ç®—å‡ºçš„æ–°é«˜åº¦ï¼Œç¡®ä¿æ–‡æœ¬åŒºåŸŸå¯ä»¥å®Œå…¨æ˜¾ç¤ºæ‰€æœ‰æ–‡æœ¬å†…å®¹ã€‚
}
document.getElementById('user-input').addEventListener('input', autoResizeTextarea);//ä¸ºIDä¸ºuser-inputçš„æ–‡æœ¬è¾“å…¥æ¡†æ·»åŠ äº†ä¸€ä¸ªinputäº‹ä»¶ç›‘å¬å™¨ã€‚å½“ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å†…å®¹æ—¶ï¼ŒautoResizeTextareaå‡½æ•°å°†è¢«è°ƒç”¨ã€‚
  ```

### 4.9 å°†æ¶ˆæ¯æ·»åŠ åˆ°é¡µé¢
```javascript
//å°†æ¶ˆæ¯æ·»åŠ åˆ°é¡µé¢
function addMessageToChat(text, sender) {
            const chatContainer = document.getElementById('chat-container');//è·å–èŠå¤©å†…å®¹æ˜¾ç¤ºåŒºåŸŸçš„ DOM å…ƒç´ ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™å˜é‡ chatContainerã€‚
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;//è®¾ç½® messageDiv çš„ className å±æ€§ã€‚è¿™ä½¿å¾—è¯¥æ¶ˆæ¯å…·æœ‰åŸºæœ¬çš„æ ·å¼ä»¥åŠå‘é€è€…çš„æ ·å¼ï¼Œå½¢å¼å¦‚ message user-message æˆ– message ai-messageï¼Œå…·ä½“å–å†³äºæ¶ˆæ¯çš„å‘é€è€…ã€‚
            messageDiv.textContent = text;
            chatContainer.appendChild(messageDiv);//ä½¿ç”¨ appendChild æ–¹æ³•å°† messageDiv æ·»åŠ åˆ° chatContainer ä¸­ï¼Œè¿™æ ·ç”¨æˆ·å°±èƒ½åœ¨èŠå¤©ç•Œé¢ä¸Šçœ‹åˆ°è¯¥æ¶ˆæ¯ã€‚
            chatContainer.scrollTop = chatContainer.scrollHeight;//ä½¿å¾—èŠå¤©å®¹å™¨è‡ªåŠ¨å‘ä¸‹æ»šåŠ¨
        }        
```
### 4.10 å›è½¦é”®å‘é€æ¶ˆæ¯
```javascript
/*ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®æ—¶è§¦å‘å‘é€æ¶ˆæ¯*/
        function handleKeyPress(event) {
            if (event.key === 'Enter') {//åˆ¤æ–­ç”¨æˆ·æŒ‰ä¸‹çš„é”®æ˜¯å¦æ˜¯â€œå›è½¦â€é”®ã€‚
                sendMessage();//å¦‚æœæ˜¯ï¼Œåˆ™è°ƒç”¨ sendMessage() å‡½æ•°å‘é€æ¶ˆæ¯ã€‚
            }
        }    
```
### 4.11 è¾“å…¥æ¡†æç¤ºæ¶ˆæ¯
```javascript
/*èšç„¦è¾“å…¥æ¡†æ—¶ç§»é™¤æç¤ºä¿¡æ¯ï¼Œå¤±ç„¦æ—¶æ¢å¤æç¤ºä¿¡æ¯*/
        function clearPlaceholder() {
    const userInput = document.getElementById('user-input');
    userInput.placeholder = ''; // æ¸…ç©ºå ä½ç¬¦
}
function restorePlaceholder() {
    const userInput = document.getElementById('user-input');
    if (!userInput.value) { // å¦‚æœå†…å®¹ä¸ºç©ºï¼Œåˆ™æ¢å¤å ä½ç¬¦
        userInput.placeholder = 'è¾“å…¥æ‚¨çš„é—®é¢˜...';
    }
}
```
### 4.12 å‘é€æ¶ˆæ¯
```javascript
//å‘é€æ¶ˆæ¯
function sendMessage() {
            const userInput = document.getElementById('user-input');
            const message = userInput.value.trim();
            if (message && currentChatId) {//æ£€æŸ¥ message æ˜¯å¦éç©ºï¼ˆå³ç”¨æˆ·æ˜¯å¦è¾“å…¥äº†å†…å®¹ï¼‰å¹¶ä¸”å½“å‰èŠå¤©ä¼šè¯ ID (currentChatId) æ˜¯å¦æœ‰æ•ˆã€‚å¦‚æœä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼Œæ‰ä¼šç»§ç»­æ‰§è¡Œåç»­çš„é€»è¾‘ã€‚
                addMessageToChat(message, 'user');//è°ƒç”¨ addMessageToChat() å‡½æ•°å°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ·»åŠ åˆ°èŠå¤©ç•Œé¢ä¸Šï¼Œå¹¶æ ‡è®°ä¸ºç”¨æˆ·å‘é€çš„æ¶ˆæ¯ã€‚
                const currentChat = chats.find(c => c.id === currentChatId);//åœ¨ chats æ•°ç»„ä¸­æŸ¥æ‰¾å½“å‰æ´»åŠ¨èŠå¤©ä¼šè¯ï¼Œå°†æ‰¾åˆ°çš„èŠå¤©å¯¹è±¡èµ‹å€¼ç»™ currentChat å˜é‡ã€‚
                currentChat.messages.push({ text: message, sender: 'user' });//å°†ç”¨æˆ·çš„æ¶ˆæ¯æ–‡æœ¬åŠå…¶å‘é€è€…ä¿¡æ¯ä»¥å¯¹è±¡çš„å½¢å¼ä¿å­˜åˆ° currentChat.messages æ•°ç»„ä¸­ï¼Œä»¥ä¾¿åç»­æŸ¥é˜…ã€‚
  
                userInput.value = '';//æ¸…ç©ºç”¨æˆ·è¾“å…¥æ¡†çš„å†…å®¹ã€‚
               // æ¨¡æ‹Ÿ AI å›å¤
                setTimeout(() => {//ä½¿ç”¨ setTimeout å‡½æ•°ä»¥ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰çš„å»¶è¿Ÿæ¥æ¨¡æ‹Ÿ AI çš„ååº”æ—¶é—´ã€‚
    const aiResponse = generateAIResponse(message, currentChat.context, currentMode);//è°ƒç”¨ generateAIResponse å‡½æ•°ï¼Œä¼ å…¥ç”¨æˆ·æ¶ˆæ¯ã€å½“å‰èŠå¤©ä¸Šä¸‹æ–‡å’Œå½“å‰æ¨¡å¼ï¼ˆå¦‚ç®€æ´æˆ–ä¸“ä¸šæ¨¡å¼ï¼‰ï¼Œæ¥ç”Ÿæˆ AI çš„å“åº”ã€‚

    addMessageToChat(aiResponse, 'ai');//å°† AI ç”Ÿæˆçš„å“åº”æ·»åŠ åˆ°èŠå¤©ç•Œé¢ï¼Œä½¿ç”¨ addMessageToChat å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º 'ai' è¡¨ç¤ºæ¶ˆæ¯æ¥æºä¸º AIã€‚
    currentChat.messages.push({ text: aiResponse, sender: 'ai' });//å°† AI çš„æ¶ˆæ¯ä¹Ÿè®°å½•åœ¨ currentChat.messages æ•°ç»„ä¸­ã€‚

    
    updateContext(currentChat, aiResponse);//è°ƒç”¨ updateContext() å‡½æ•°ï¼Œæ›´æ–°å½“å‰èŠå¤©çš„ä¸Šä¸‹æ–‡ã€‚
    
    saveChats();//è°ƒç”¨ saveChats() å‡½æ•°å°†å½“å‰çš„èŠå¤©ä¼šè¯ä¿¡æ¯ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ä¸­ã€‚
  }, 1000);
            }
        }
```
### 4.13 ç”Ÿæˆä¸åŒæ¨¡å¼ä¸‹çš„ AI å“åº”
```javascript
// ç”ŸæˆAIçš„å“åº”
        function generateAIResponse(userMessage, context, mode) {
  const responses = {//åˆ›å»ºä¸€ä¸ªåä¸º responses çš„å¯¹è±¡ï¼Œç”¨äºå­˜å‚¨ä¸åŒæ¨¡å¼ä¸‹çš„å“åº”æ¨¡æ¿ã€‚
    // ç®€æ´æ¨¡å¼
    concise: [
      {
        keywords: ["ä½ å¥½", "å—¨", "æ‚¨å¥½"],
        templates: [
          "ä½ å¥½!",
          "æ‚¨å¥½!",
          "å—¨!"
        ]
        },
        ......
    ]
      
      // ä¸“ä¸šæ¨¡å¼
    professional: [
      {
        keywords: ["ä½ å¥½", "å—¨", "æ‚¨å¥½"],
        templates: [
          "æ‚¨å¥½!å¾ˆé«˜å…´ä¸ºæ‚¨æä¾›ä¸“ä¸šæœåŠ¡ã€‚è¯·é—®æ‚¨ä»Šå¤©æœ‰ä»€ä¹ˆå…·ä½“çš„é—®é¢˜æˆ–éœ€æ±‚å—?",
          "æ‚¨å¥½!æ¬¢è¿ä½¿ç”¨æˆ‘ä»¬çš„ä¸“ä¸šå’¨è¯¢æœåŠ¡ã€‚æˆ‘ä»¬å¯ä»¥å°±ä»»ä½•ä¸“ä¸šè¯é¢˜è¿›è¡Œæ·±å…¥è®¨è®ºã€‚",
          "æ‚¨å¥½!ä½œä¸ºæ‚¨çš„ä¸“ä¸šåŠ©æ‰‹,æˆ‘éšæ—¶å‡†å¤‡ä¸ºæ‚¨è§£ç­”å„ç§å¤æ‚é—®é¢˜ã€‚è¯·é—®æ‚¨éœ€è¦å“ªæ–¹é¢çš„å¸®åŠ©?"
        ]
      },
      ......
    ]
  }
        }
```
### 4.14 çœ‹æ˜¯å¦åŒ¹é…å…³é”®è¯
```javascript
// æŸ¥æ‰¾åŒ¹é…çš„å…³é”®è¯å“åº”
  for (let response of responses[mode]) {// éå†å“åº”åˆ—è¡¨
    // å¦‚æœç”¨æˆ·æ¶ˆæ¯åŒ…å«å…³é”®è¯,è¿”å›å¯¹åº”çš„å“åº”
    if (response.keywords.some(keyword => userMessage.toLowerCase().includes(keyword))) {
      return response.templates[Math.floor(Math.random() * response.templates.length)];
    }
  }

  // å¦‚æœæ²¡æœ‰åŒ¹é…çš„å…³é”®è¯,ä½¿ç”¨é»˜è®¤å“åº”
  const defaultResponses = {
    concise: [
      `ç®€å•è¯´è¯´"${userMessage}"å§ã€‚`,
      `"${userMessage}"ï¼Œæ‚¨è§‰å¾—å‘¢?`,
      `å…³äº"${userMessage}"ï¼Œæ‚¨çš„æƒ³æ³•æ˜¯?`
    ],
    professional: [
      `æ‚¨æåˆ°çš„"${userMessage}"æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ·±åº¦çš„è¯é¢˜ã€‚ä»ä¸“ä¸šè§’åº¦æ¥çœ‹,è¿™æ¶‰åŠåˆ°å¤šä¸ªæ–¹é¢çš„è€ƒé‡ã€‚æˆ‘ä»¬å¯ä»¥ä»ç†è®ºåŸºç¡€ã€å®é™…åº”ç”¨å’Œæœªæ¥å‘å±•ä¸‰ä¸ªç»´åº¦æ¥è®¨è®ºã€‚æ‚¨æƒ³å…ˆæ¢è®¨å“ªä¸ªæ–¹é¢?`,
      `"${userMessage}"è¿™ä¸ªè¯é¢˜åœ¨å­¦æœ¯ç•Œä¸€ç›´æœ‰è®¸å¤šäº‰è®®ã€‚ä¸åŒçš„ç ”ç©¶æ–¹æ³•å’Œç†è®ºæ¡†æ¶ä¼šå¯¼è‡´ä¸åŒçš„ç»“è®ºã€‚æ‚¨å¯¹è¿™ä¸ªè¯é¢˜æœ‰ä»€ä¹ˆç‰¹å®šçš„ç ”ç©¶å…´è¶£å—?æˆ‘ä»¬å¯ä»¥æ·±å…¥æ¢è®¨ç›¸å…³çš„å­¦æœ¯æ–‡çŒ®ã€‚`,
      `å…³äº"${userMessage}",è¿™æ˜¯ä¸€ä¸ªè·¨å­¦ç§‘çš„ç ”ç©¶é¢†åŸŸã€‚æˆ‘ä»¬éœ€è¦ç»“åˆå¿ƒç†å­¦ã€ç¤¾ä¼šå­¦ã€ç»æµå­¦ç­‰å¤šä¸ªå­¦ç§‘çš„çŸ¥è¯†æ¥å…¨é¢ç†è§£ã€‚æ‚¨å¯¹å“ªä¸ªå…·ä½“çš„ç ”ç©¶æ–¹å‘æ„Ÿå…´è¶£?æˆ‘å¯ä»¥ä¸ºæ‚¨æä¾›ç›¸å…³çš„ä¸“ä¸šè§è§£ã€‚`
    ]
  };

  return defaultResponses[mode][Math.floor(Math.random() * defaultResponses[mode].length)];//æ ¹æ®å½“å‰æ¨¡å¼ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªé»˜è®¤å“åº”è¿›è¡Œè¿”å›
```

### 4.15 è®¾ç½®æ¨¡æ€æ¡†çš„æ˜¾ç¤ºå’Œéšè—
```javascript
//æ‰“å¼€è®¾ç½®æ¨¡æ€æ¡†ï¼ˆå¼¹å‡ºçª—å£ï¼‰
        function openSettings() {
            document.getElementById('settings-modal').style.display = 'block';//é»˜è®¤æƒ…å†µä¸‹ï¼Œdisplayå±æ€§æ˜¯noneï¼ˆéšè—çŠ¶æ€ï¼‰ï¼Œè€Œè®¾ç½®ä¸ºblockåˆ™æ˜¾å¼ä½¿å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚
        }
//å…³é—­è®¾ç½®æ¨¡æ€æ¡†
        function closeSettings() {
            document.getElementById('settings-modal').style.display = 'none';//è®¾ç½®displayå±æ€§ä¸ºnoneï¼Œåˆ™éšè—è®¾ç½®æ¨¡æ€æ¡†ã€‚
        }
```
### 4.16 é€‰æ‹©æ–°çš„ä¸»é¢˜é¢œè‰²
```javascript
// é€‰æ‹©æ–°çš„ä¸»é¢˜é¢œè‰²    
        function changeThemeColor() {
    const newColor = document.getElementById('theme-color').value; // è·å–ç”¨æˆ·é€‰æ‹©çš„é¢œè‰²
    document.documentElement.style.setProperty('--primary-color', newColor); // æ›´æ–°ä¸»é¢œè‰²
```
### 4.17 è®¾ç½®æ¨¡å¼æ›´æ”¹æŒ‰é’®é¢œè‰²å˜æ·±çš„æ•ˆæœ
```javascript
// è®¾ç½®é¼ æ ‡åœ¨æ›´æ”¹æ¨¡å¼çš„æŒ‰é’®æ‚¬åœæ—¶çš„é¢œè‰²
    const modeToggleButton = document.getElementById('mode-toggle');
    modeToggleButton.onmouseover = function() {
        modeToggleButton.style.backgroundColor = shadeColor(newColor, -20); // è°ƒç”¨shadeColorå‡½æ•°ï¼Œæ·±è‰²å¤„ç†-20ï¼ˆç¨å¾®å˜æ·±ï¼‰
    };

    modeToggleButton.onmouseout = function() {
        modeToggleButton.style.backgroundColor = newColor; // æ¢å¤æ­£å¸¸é¢œè‰²
    };
}

// å®ç°é¢œè‰²å˜æ·±çš„å‡½æ•°ï¼ˆè¯¥å‡½æ•°çš„ä¸»è¦åŠŸèƒ½æ˜¯æ ¹æ®è¾“å…¥çš„åå…­è¿›åˆ¶é¢œè‰²åŠå˜åŒ–ç™¾åˆ†æ¯”ç”Ÿæˆä¸€ä¸ªæ–°çš„é¢œè‰²å€¼ï¼Œï¼‰
function shadeColor(color, percent) {
    const R = parseInt(color.slice(1, 3), 16);
    const G = parseInt(color.slice(3, 5), 16);
    const B = parseInt(color.slice(5, 7), 16);

    return `#${((1 << 24) + (Math.min(255, R + R * (percent / 100)) << 16) 
           + (Math.min(255, G + G * (percent / 100)) << 8) 
           + Math.min(255, B + B * (percent / 100)))
           .toString(16).slice(1)}`;
}
```
### 4.18 æ”¹å˜å­—ä½“å¤§å°
```javascript
//æ”¹å˜ç½‘é¡µå­—ä½“çš„å¤§å°
        function changeFontSize() {
            const size = document.getElementById('font-size').value;
            document.body.style.fontSize = size + 'px';//è®¾ç½®ä»¥åƒç´ ä¸ºå•ä½çš„å­—ä½“å¤§å°ã€‚
            document.getElementById('font-size-value').textContent = size + 'px';//æ›´æ–°æ˜¾ç¤ºå­—ä½“å¤§å°çš„æ ‡ç­¾ã€‚
            localStorage.setItem('fontSize', size);//ä¿å­˜å­—ä½“å¤§å°è®¾ç½®
        }
```
### 4.19 ä¿å­˜å’ŒåŠ è½½ä¸ªæ€§åŒ–è®¾ç½®
```javascript
// åŠ è½½ä¿å­˜çš„è®¾ç½®
        function loadSettings() {
            const savedColor = localStorage.getItem('themeColor');//è¯»å–ä¿å­˜çš„ä¸»é¢˜é¢œè‰²
            if (savedColor) {//å¦‚æœæœ‰ä¿å­˜çš„ä¸»é¢˜é¢œè‰²ï¼Œåˆ™è®¾ç½®ä¸»é¢˜é¢œè‰²é€‰æ‹©æ¡†çš„å€¼
                document.getElementById('theme-color').value = savedColor;
                document.documentElement.style.setProperty('--primary-color', savedColor);
            }

            const savedFontSize = localStorage.getItem('fontSize');//è¯»å–ä¿å­˜çš„å­—ä½“å¤§å°
            if (savedFontSize) {//å¦‚æœæœ‰ä¿å­˜çš„å­—ä½“å¤§å°ï¼Œåˆ™è®¾ç½®å­—ä½“å¤§å°é€‰æ‹©æ¡†çš„å€¼
                document.getElementById('font-size').value = savedFontSize;
                document.body.style.fontSize = savedFontSize + 'px';
                document.getElementById('font-size-value').textContent = savedFontSize + 'px';
            }
        }
```
### 4.20 åˆå§‹åŒ–ç”¨æˆ·ç•Œé¢
```javascript
// åˆå§‹åŒ–
        loadChats();//åŠ è½½ä¹‹å‰ä¿å­˜çš„èŠå¤©è®°å½•
        loadSettings();//åŠ è½½ä¿å­˜çš„è®¾ç½®
        if (chats.length === 0) {//åˆ¤æ–­chatsæ•°ç»„çš„é•¿åº¦æ˜¯å¦ä¸º0ï¼Œä¹Ÿå°±æ˜¯æ£€æŸ¥æ˜¯å¦æœ‰å¯æ¢å¤çš„èŠå¤©è®°å½•
            createNewChat();//å¦‚æœæ²¡æœ‰å¯æ¢å¤çš„èŠå¤©è®°å½•ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„èŠå¤©è®°å½•
        } else {//å¦‚æœæœ‰å¯æ¢å¤çš„èŠå¤©è®°å½•ï¼Œåˆ™åˆ‡æ¢åˆ°æœ€åä¸€ä¸ªèŠå¤©è®°å½•
            switchChat(chats[chats.length - 1].id);
        }

        // å½“ç”¨æˆ·åœ¨è®¾ç½®æ¨¡æ€æ¡†å¤–éƒ¨åŒºåŸŸç‚¹å‡»æ—¶ï¼Œæ¨¡æ€æ¡†å°†è°ƒç”¨ closeSettings() å‡½æ•°è¢«å…³é—­ï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨ä¸éœ€è¦æ¨¡æ€æ¡†æ—¶è½»æ¾å…³é—­å®ƒï¼Œè€Œæ— éœ€å¯»æ‰¾å…³é—­æŒ‰é’®ã€‚
        window.onclick = function(event) {
            if (event.target == document.getElementById('settings-modal')) {
                closeSettings();
            }
        }
```

